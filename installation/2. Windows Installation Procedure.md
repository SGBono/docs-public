# Windows Installation Procedure

## Contents

- [Rationale](#rationale---why-not-just-clone-it)

- [Normal Installation (Online Install)](#normal-installation-online-install)
  
  - [Booting from USB](#booting-from-the-usb)
  
  - [Installing Windows (Stage 1)](#installing-windows-stage-1)
  
  - [Installing Windows (Stage 2)](#installing-windows-stage-2)
  
  - [Installing Windows (Stage 3)](#installing-windows-stage-3)

- [Server not working (Offline Install)](#server-not-working-offline-install)

- Known Issues

   - None

## Rationale - why not just clone it?

2 main reasons:

- Speed

- Modularity

In our testing, we found that it was faster to use our method of USB + server compared to cloning a VHD to the drives. Not only are we able to deploy more Windows installations at the same time due to the greater number of USBs we have compared to USB to NVMe/USB to SATA adapters, we are also able to add, remove and update the programs that are deployed to the devices right from one location - the server. It would also be much easier if the modification of the image itself is required due to the much lighter footprint of the ISO image (~6GB) compared to a full Windows install (~30GB).

## Normal Installation (Online Install)

Over the course of the development of the installation scripts, the installation procedure has been heavily simplified to require minimal user interaction. However, there is still a procedure for the parts of the process that have no choice but to require user interaction.

#### Booting from the USB

1. Obtain a custom Windows install USB drive. They can be found in one of the boxes SGBono has. **AVOID USB drives that have been fully wrapped in masking tape.**

![image](https://github.com/user-attachments/assets/07e4d5eb-ec46-4e20-bc17-a987dc397d62)

4. Insert the USB drive into the USB port of the target device.

![image](https://github.com/user-attachments/assets/5ff39815-504f-45c8-bb65-31f6ed77d571)

7. Turn on the target device.

8. Strike the **temporary startup key** on the keyboard repeatedly (**F12** on most laptops). Continue striking the key even after seeing the manufacturer's logo. until the temporary startup device screen shows up, which should look something lke this.

![Windows 10 boot menu boot device - darelomb](https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fcampaign.ecs.com.tw%2Fimages%2FG_FAQ%2Fstep_1.jpg&f=1&nofb=1&ipt=ccc2cc8880a07431c7527431aa23ee3e8f616dd009ddfb026099d30fde15d48e&ipo=images)

11. Select the option that says **UEFI: USB Flash Drive** or something similar.

12. If the device previously had Secure Boot enabled, you will be greeted with this screen. If you are presented with a screen with a large "Ventoy" logo, skip to step **15**. Otherwise, strike **Enter** on the keyboard to select OK.

![verification-failed-0x1a-security-violation](https://www.technewstoday.com/wp-content/uploads/2023/07/verification-failed-0x1a-security-violation.webp)

15. Now, strike any key on your keyboard when this screen shows up.

![shim-uefi-key-management](https://www.technewstoday.com/wp-content/uploads/2023/07/shim-uefi-key-management.webp)

18. Select **Enroll key from disk** and press **Enter**.

![enroll-key-from-disk](https://www.technewstoday.com/wp-content/uploads/2023/07/enroll-key-from-disk.webp)

9. Select **VTOYEFI** and press **Enter**.

![vtoyefi-enroll-key](https://www.technewstoday.com/wp-content/uploads/2023/07/vtoyefi-enroll-key.webp)

10. Select **ENROLL_THIS_KEY_IN_MOKMANAGER.cer** and press **Enter**.

![enroll-this-key-in-mokmanager](https://www.technewstoday.com/wp-content/uploads/2023/07/enroll-this-key-in-mokmanager.webp)

11. Select **Continue** and press **Enter**.

![continue-to-enroll-mok](https://www.technewstoday.com/wp-content/uploads/2023/07/continue-to-enroll-mok.webp)

12. Select **Yes** and press **Enter** to enroll the keys.

![enroll-mok-keys-confirm](https://www.technewstoday.com/wp-content/uploads/2023/07/enroll-mok-keys-confirm.webp)

13. Finally, select **Reboot** and press **Enter**.

![reboot-mok-management](https://www.technewstoday.com/wp-content/uploads/2023/07/reboot-mok-management.webp)

14. Repeat steps **4-5** to boot from the USB drive again.

15. You will then be presented with this screen:

![image](https://github.com/user-attachments/assets/36aeaab1-362b-4b2f-9c34-18975bdf88df)

Typically, you will want to select the **Windows 11** option. However, on older laptops - the ones Windows 11 does not "officially" support, namely those with:

- An Intel CPU older than 8th Gen, or

- An AMD CPU before the Zen+ generation, which can be simplified as anything before Ryzen 2000 for the most part,

it would be better to choose the **Windows 10** option.

18. When prompted, select the **Boot in normal mode** option.

![Wimboot mode de Ventoy](https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fforum.pcastuces.com%2Fimg3%2F7e70e51152ee8da59c373ca2d137ba2d.JPG&f=1&nofb=1&ipt=31c24d92ec7be21350d6e1294ee84e672e20ec9e0adffcf277fc577693dca6c4&ipo=images)

### Installing Windows (Stage 1)

1. On devices with no valid Windows licence previously installed (which is VERY unlikely unless the device did not have Windows on it previously), you will be prompted to select an edition.

![image](https://github.com/user-attachments/assets/07d88a4b-705d-47c8-b516-767ad938c4bf)

Unless otherwise specified on site, select the **Windows 10/11 Pro** edition and click **Next**.

2. That's about it for this part, it has been automated for your convenience. Just wait for the installation to finish.

![image](https://github.com/user-attachments/assets/8b6490a4-aa51-43a8-840c-aedee32a09c6)

![image](https://github.com/user-attachments/assets/09d27be2-8455-477d-97a9-be4cec3458e4)

3. Windows will restart itself automatically

### Installing Windows (Stage 2)

1. This part has also been automated for your convenience. Just let Windows finish installing.

![image](https://github.com/user-attachments/assets/b2b4f108-af9f-4fa4-8726-f2b02bd0953d)

![Screenshot 2024-08-10 205957](https://github.com/user-attachments/assets/4bab914b-ce86-4e59-a432-31b5328d37cc)

### Installing Windows (Stage 3)

1. During the first login, you will hear some music start to play. This is part of the sound test. If you hear any crackling in the laptop's speakers or even hear nothing at all, be sure to note that down on a piece of masking tape.

![Screenshot 2024-08-10 211253](https://github.com/user-attachments/assets/7a4d3e6f-916e-4b68-bcb9-4549fef3a652)

2. After a while, you will see this screen. Here, you want to click **Load Server Config**. Your desktop will disappear, do not panic if that happens.

![Screenshot 2024-08-10 211441](https://github.com/user-attachments/assets/1902c41f-30ec-4928-88bb-1ab2d4fe112d)

3. Wait for the **driver installation utility** to launch.

![Screenshot 2024-08-10 214756](https://github.com/user-attachments/assets/7f4c1183-d602-4c59-a727-8734ecea34b4)

4. When the driver installation window shows up, click on **Select all** followed by **Install**. (Note: You should see way more drivers than what is listed here). If you do not see any drivers listed, please proceed to **Troubleshooting - No drivers listed in Snappy Driver Installer**.

![Screenshot 2024-08-10 214845](https://github.com/user-attachments/assets/8dcca9b3-40f6-43c1-944c-b7698a9b8b11)

5. Wait for the drivers to install.

6. Once the drivers have finished installing (you see a flashing green **Installation completed** message or a flashing orange **requires a restart** message), close the app.

![Screenshot 2024-08-10 215143](https://github.com/user-attachments/assets/e74a447d-0f5a-4837-80b3-412c177bc809)

7. If everything went well and installed successfully, click on **Yes** in the following screen.

![Screenshot 2024-08-10 215236](https://github.com/user-attachments/assets/969bed77-60ee-4142-a6f9-b3a265b0ecc6)

8. Several programs will now begin to install. Again, this part has been fully automated for your convenience.

![Screenshot 2024-08-10 215417](https://github.com/user-attachments/assets/2670d5c6-9797-47d9-a64e-2c0fdd9ef0c5)

9. A system report will be generated. **Write down** all the fields under **Note the following down** on a piece of masking tape and stick it to the back of the device.

![Screenshot 2024-08-10 215603](https://github.com/user-attachments/assets/838e26c6-282a-4414-88bc-bd3b8d8cc5aa)

10. **IMPORTANT:** Before shutting down, check if the script is still running by checking the taskbar. This is to allow the script to delete itself and our infrastructure's sensitive credentials before we dispatch the device. **Failure to do so could result in serious consequences, including from bad actors who may reverse engineer the script and attack our infrastructure**.

![Screenshot 2024-08-10 215603 (1)](https://github.com/user-attachments/assets/476c24cd-f906-4062-b688-b40037b08ebd)

![Screenshot 2024-08-10 220118](https://github.com/user-attachments/assets/afdc1ae2-11a9-4d5b-aa0e-8a0009c72e58)

11. After ensuring that the script is no longer running, you can safely shut down the device and put it in the **Done** pile.


## Server not working (Offline install)
